#!/usr/bin/env python
# -*- coding: utf-8 -*-

import requests
import re
import sys

log = '''
===============================================
  _____  _      ____            _            
 |  __ \(_)    |  _ \          | |           
 | |  | |_ _ __| |_) |_   _ ___| |_ ___ _ __ 
 | |  | | | '__|  _ <| | | / __| __/ _ \ '__|
 | |__| | | |  | |_) | |_| \__ \ ||  __/ |   
 |_____/|_|_|  |____/ \__,_|___/\__\___|_|   
                                             
=============================================== 
'''
print log

def usage():
    print "usage:"
    print "python dirbuster.py <http://www.google.com> <wordlist>"
    print ""

def dirbuster(target_url, dir_list):
    print '---- Scanning URL:' + target_url + '\n'
    headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393'}
    for line in dir_list:
        test_url = target_url + '/' + line.strip("\n")
        result = requests.get(test_url, headers = headers)
        sys.stdout.write('                                                          ' + '\r')
        sys.stdout.flush()
        sys.stdout.write('--> Testing: ' + (str(line).strip('\n')) + '\r')
        sys.stdout.flush()        
        if result.status_code == requests.codes.ok:
            print '[+] [' + str(result.status_code) + '] ' + test_url

if __name__ == '__main__':
    if len(sys.argv) == 3:
        a = sys.argv[1]
        if re.match(r'^http:/{2}\w.+$', a):
            target_url = a
        else:
            print 'Invalid URL'
            usage()
            exit()
        dir_list = open(sys.argv[2], 'r')
    elif "-h" in sys.argv[1:]:
        usage()
        exit()
    else:
        usage()
        exit()
    dirbuster(target_url, dir_list)